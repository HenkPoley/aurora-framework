<!DOCTYPE html>
<html>
	<head>
		<title>test admin links</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<script type="text/javascript" src="../../node_modules/underscore/underscore-min.js"></script>
		<script type="text/javascript">
			var aHashes = [
				'db',
				'files',
				'mail',
				'mail/domains',
				'mail/domains/create',
				'mail/d5',
				'tenants',
				'tenants/create',
				't11',
				't11/files',
				't11/mail',
				't11/mail/domains',
				't11/mail/domains/create',
				't11/mail/d5',
				't11/mail/d5/accounts',
				't11/mail/d5/accounts/create',
				't11/mail/d5/a21',
				't11/users',
				't11/users/create',
				't11/u15',
				't11/u15/mail',
				't11/u15/mail/accounts',
				't11/u15/mail/accounts/create',
				't11/u15/mail/a21',
				't11/u15/files',
				'users',
				'users/create',
				'u15',
				'u15/mail',
				'u15/files',
			];
			var pInt = function (mValue, iDefault)
			{
				var iValue = window.parseInt(mValue, 10);
				if (isNaN(iValue))
				{
					iValue = !isNaN(iDefault) ? iDefault : 0;
				}
				return iValue;
			};
			var parse = function (sParams)
			{
				var
					aEntitiesNames = ['tenants', 'users'],
					aParams = sParams.split('/'),
					iIndex = 0,
					aEntities = [],
					sCurrEntity = ''
				;

				_.each(aEntitiesNames, function (sEntity) {
					if (aParams[iIndex] && sEntity === aParams[iIndex])
					{
						sCurrEntity = sEntity;
						iIndex++;
					}
					if (aParams[iIndex] && sEntity.substr(0, 1) === aParams[iIndex].substr(0, 1) && pInt(aParams[iIndex].substr(1)) > 0)
					{
						aEntities.push(pInt(aParams[iIndex].substr(1)));
						iIndex++;
					}
					else
					{
						aEntities.push(0);
					}
				});

				console.log(sParams, aEntities, sCurrEntity);
			};

			//_.each(aHashes, function (sHash) {
			//	parse(sHash);
			//});
			
			var isPositiveNumber = function (mValue)
			{
				return typeof mValue === 'number' && mValue > 0;
			};
			
			var get = function (aEntities, sCurrEntity, sLast)
			{
				var
					aEntitiesNames = ['tenants', 'users'],
					aResult = ['admin']
				;

				_.each(aEntitiesNames, function (sEntityName, iIndex) {
					if (isPositiveNumber(aEntities[iIndex]))
					{
						aResult.push(sEntityName.substr(0,1) + aEntities[iIndex]);
					}
					else if (sCurrEntity === sEntityName)
					{
						aResult.push(sEntityName);
					}
				});
				
				if (sLast !== '')
				{
					aResult.push(sLast);
				}

				console.log(aResult.join('/'), aEntities, sCurrEntity, sLast);
			};
			
			var aData = [
				{Entities: [0, 0], Current: '', Last: 'db'},
				{Entities: [0, 0], Current: '', Last: 'files'},
				{Entities: [0, 0], Current: '', Last: 'mail/domains'},
				{Entities: [0, 0], Current: '', Last: 'mail/domains/create'},
				{Entities: [0, 0], Current: '', Last: 'mail/d5'},
				{Entities: [0, 0], Current: 'tenants', Last: ''},
				{Entities: [0, 0], Current: 'tenants', Last: 'create'},
				{Entities: [11, 0], Current: 'tenants', Last: 'files'},
				{Entities: [11, 0], Current: 'tenants', Last: 'mail'},
				{Entities: [11, 0], Current: 'tenants', Last: 'mail/domains'},
				{Entities: [11, 0], Current: 'tenants', Last: 'mail/domains/create'},
				{Entities: [11, 0], Current: 'tenants', Last: 'mail/d5'},
				{Entities: [11, 0], Current: 'tenants', Last: 'mail/d5/accounts'},
				{Entities: [11, 0], Current: 'users', Last: ''},
				{Entities: [11, 0], Current: 'users', Last: 'create'},
				{Entities: [11, 15], Current: 'users', Last: 'mail'},
				{Entities: [11, 15], Current: 'users', Last: 'mail/accounts'},
				{Entities: [11, 15], Current: 'users', Last: 'files'},
				{Entities: [0, 0], Current: 'users', Last: ''},
				{Entities: [0, 15], Current: 'users', Last: ''},
				{Entities: [0, 15], Current: 'users', Last: 'mail'}
			];
			
			_.each(aData, function (oData) {
				get(oData.Entities, oData.Current, oData.Last);
			});
		</script>
	</head>
	<body>
	</body>
</html>
